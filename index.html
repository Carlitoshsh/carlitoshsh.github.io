<!--
Autor: Carlos Gómez
Carrera: Ingeniería de Sistemas y Computación
Institución: Universidad Nacional de Colombia
Asignatura: Gráfica Interactiva
-->
<!doctype html>
<html>
    <head>
        <!-- Se le indica al archivo la ubicación de los estilos -->
        <link rel="stylesheet" type="text/css" href="css/estilos.css">
        <!-- Se usa el formato de codificación UTF-8 para que reconozca ciertos simbolos -->
        <meta charset="UTF-8">
        <!-- Este es el icono que se muestra en la pestaña del navegador junto con el titulo de la pagina -->
        <link rel="shortcut icon" type="image/png" href="images/png/ball.png"/>
        <!-- Titulo de la pagina -->
        <title> Momentos deportivos </title>
        <!-- Detecta si es un dispositivo movil y se adapta -->
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <script src="js/phaser.js" type="text/javascript"></script>
    </head>
    <body>
        <!-- Aquí se muestra la barra de navegación junto con una barra de titulo. -->
        <nav class="navegacion">
            <!-- Tenemos la primera sección en nuestra pagina, la cual muestra el logo, a modo de "titulo" -->
            <div id = "titulo">
                <img src="images/png/titulo.png">
            </div>
            <!-- Aquí se muestra la barra de navegación, como una lista HTML. Cada elemento importa un icono de Icons8. -->
            <!-- En total son 6 paginas. 5 sobre glorias del deporte colombiano: una muestra noticias, y las otras muestran
            representantes dependiendo de la categoria. Acerca de muestra el mapa del sitio, los creditos y la fuente de la información -->
            <!-- En cada pagina se muestra cual esta activa, llamando a la clase active del estilo css -->
            <ul>
                <li><a class = "active" href="index.html"><img src="https://maxcdn.icons8.com/Color/PNG/24/Very_Basic/home-24.png" title="Inicio" width="30"><br>Juego</a></li>
                <li><a href="reglas.html"><img src="https://maxcdn.icons8.com/Color/PNG/24/Sports/regular_biking-24.png" title="Cicilismo" width="30"><br>¿Cómo se juega?</a></li>
                <li id="acercade"><a href="acerca.html"><img src="https://maxcdn.icons8.com/Color/PNG/24/Very_Basic/about-24.png" title="Acerca" width="30"><br>Acerca de</a></li>
            </ul>
        </nav>

	<div class="grupo">
        <hr>
    	<div id="game"></div>
        <script type="text/javascript">
        /* Phaser es una libreria en JavaScript usada para el desarrollo de juegos en web. 
            Los codigos utilizados aqui hacen parte de la seccion de aprendizaje de Phaser
            (http://phaser.io/learn) */

            /* Se crea un nuevo juego*/
            var game = new Phaser.Game(640, 480, Phaser.AUTO, 'game', { preload: preload, create: create, update: update });

            function preload() {
                // Se cargan Imagenes y archivos de recurso
                /*  Se carga el tilemap (mapa de fondo). El mapa fue realizado en un programa 
                    llamado Tiled (http://www.mapeditor.org/download.html). */
                game.load.tilemap('mapa', 'images/map/map.json', null, Phaser.Tilemap.TILED_JSON);

                /* El tilemap es un archivo que contiene secciones de una imagen, por asi decirlo. 
                    Esta imagen contiene los patrones presentes en el mapa, por eso debe cargarse */
                game.load.image('tiles', 'images/map/default_tiles_x.png');

                /*Prueba*/
                // game.load.spritesheet('ms', 'images/map/metalslug_mummy37x45.png', 37, 45, 18);
                game.load.image('car', 'images/map/car90.png');
            }

            /* Se crean las variables map (Mapa) y layer (Capa)*/
            var map;
            var layer;
            var sprite;
            var cursors;

            function create() {
                // Aqui se crean elementos como el personaje, los enemigos, los sonidos, el fondo del juego, etc
                //game.stage.backgroundColor = '#787878';

                //  Añade el mapa.
                map = game.add.tilemap('mapa');

                /* El primer parametro es el nombre de la imagen de donde
                 se obtuvo el patron que esta presente en el archivo json. El segundo 
                 es una referencia a la imagen (al archivo) que contiene dicho patron*/
                map.addTilesetImage("other",'tiles');
                
                /*Crea una capa a partir del mapa*/
                layer = map.createLayer('mundo');

                // Ajusta la imagen al tamaño de la capa
                layer.resizeWorld();

                /*
                sprite = game.add.sprite(40, 100, 'ms');

                sprite.animations.add('walk');

                sprite.animations.play('walk', 50, true);
                */

                sprite = game.add.sprite(450, 80, 'car');
                sprite.anchor.setTo(0.5, 0.5);

                game.physics.enable(sprite);

                game.camera.follow(sprite);

                cursors = game.input.keyboard.createCursorKeys();

                game.input.onDown.add(fillTiles, this);


            }

            function fillTiles() {

                map.fill(31, layer.getTileX(sprite.x), layer.getTileY(sprite.y), 8, 8);

            }

            function update() {
                /*
                if (sprite.x >= 300)
                {
                    sprite.scale.x += 0.01;
                    sprite.scale.y += 0.01;
                }
                */

                game.physics.arcade.collide(sprite, layer);

                sprite.body.velocity.x = 0;
                sprite.body.velocity.y = 0;
                sprite.body.angularVelocity = 0;

                if (cursors.left.isDown)
                {
                sprite.body.angularVelocity = -200;
                }
                else if (cursors.right.isDown)
                {
                sprite.body.angularVelocity = 200;
                }

                if (cursors.up.isDown)
                {
                sprite.body.velocity.copyFrom(game.physics.arcade.velocityFromAngle(sprite.angle, 300));
                }

            }

            function render() {

                game.debug.text('Click to fill tiles', 32, 32, 'rgb(0,0,0)');
                game.debug.text('Tile X: ' + layer.getTileX(sprite.x), 32, 48, 'rgb(0,0,0)');
                game.debug.text('Tile Y: ' + layer.getTileY(sprite.y), 32, 64, 'rgb(0,0,0)');

            }
        </script>
        <br>
	</div>
	
	    <!-- Este es mi "footer" (fin de pagina). Se agregan reconocimiento a Icons8 por el uso de los iconos y el link al mapa del sitio -->
	<div class="fin">
		<br>
		<p>Los iconos presentes en este sitio web son propiedad de Icons8. <a href="https://icons8.com">Icon pack by Icons8</a>.</p>
		<p><a href="acerca.html">Mapa del sitio. Glorias del Deporte Colombiano, 2016.</p>
	</div>

	</body>
</html>

